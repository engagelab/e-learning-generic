/*! generic 2015-09-28 */
"use strict";Array.prototype.repeat=function(a,b){for(;b;)return this[--b]=a,this};var HMS=angular.module("HMS",["ngRoute","ngAnimate","ngAria","ngMaterial","ngSanitize","pascalprecht.translate","ngCookies","smoothScroll","ng.deviceDetector","GDirectives"]);HMS.constant("CONSTANTS",{moduleColours:{1:"#f26767",2:"#ffd94f",3:"#ffb040",4:"#29a9c3",5:"#24baa3",6:"#95a5a5"},TOP_LEVEL_MODULE_PATH:"views/m",ICON_PATH:"views/icons/",USE_ALT_VIDEO_SERVER:!1,CROP_MIN_WIDTH:1281,GIF_MAX_WIDTH:768,MODULE_NAME_ARRAY:["Module 1","Module 2","Module 3","Module 4","Module 5","Module 6"],DICTIONARY_NAME:"json/freetext_dictionary.json",QUIZ_PASS_PERCENT:80}),HMS.config(["$routeProvider",function(a){a.when("/:module/:lingo/:anchor?",{templateUrl:function(a){return"views/m"+a.module+"/m"+a.module+".html"},controller:"IndexCtrl"}),a.otherwise({redirectTo:"/1/no"})}]),HMS.config(["$mdGestureProvider",function(a){a.skipClickHijack()}]),HMS.config(["$translateProvider",function(a){a.useSanitizeValueStrategy("sanitizeParameters"),a.useLocalStorage(),a.useStaticFilesLoader({prefix:"languages/",suffix:".json"}),a.preferredLanguage("no")}]),HMS.config(["$mdThemingProvider",function(a){a.theme("main").primaryPalette("indigo"),a.setDefaultTheme("main")}]),HMS.config(["$httpProvider",function(a){a.defaults.withCredentials=!1,a.defaults.headers.common.Accept="application/json",a.defaults.headers.common["Content-Type"]="application/json"}]),HMS.controller("IndexCtrl",["$scope","$translate","$mdSidenav","$location","$routeParams","$timeout","$window","DataService","smoothScroll","CONSTANTS",function(a,b,c,d,e,f,g,h,i,j){a.modules=j.MODULE_NAME_ARRAY,a.currentLanguage=h.applicationVariable.currentLanguage,a.dymanicTheme="default",a.currentModule="",a.searchWord="",a.searchResults=[],a.uid="";var k=!1,l="";a.$on("$viewContentLoaded",function(){""!==l&&f(function(){a.seekToAnchor(l)},500)}),a.$on("$routeChangeSuccess",function(b,c){a.closeMenu(),g.scrollTo(0,0),h.applicationVariable.currentModule=a.currentModule=c.params.module,c.params.anchor&&(l=h.applicationVariable.anchorToSeek="s"+c.params.anchor),c.params.lingo!==a.currentLanguage&&a.changeLanguage()}),a.openMenu=function(){c("right").open(),k=!0},a.closeMenu=function(){k&&c("right").close(),k=!1;var a=angular.element(document.querySelector("#content"));"undefined"!=typeof a[0]&&a[0].focus()},a.changeLanguage=function(){"en"===a.currentLanguage?a.displayLanguage="en":a.displayLanguage="no","en"===a.currentLanguage?a.currentLanguage=h.applicationVariable.currentLanguage="no":a.currentLanguage=h.applicationVariable.currentLanguage="en",b.use(a.currentLanguage),d.path(d.path().slice(0,-2)+a.currentLanguage)},a.playVideo=function(a){var b=angular.element("video")[a];b.paused?b.play():b.pause()},a.submit=function(){a.searchWord&&(a.searchResults=h.getDictionaryValues(a.searchWord.toLowerCase()))},a.seekToAnchor=function(b){l=h.applicationVariable.anchorToSeek="";var c=document.getElementById(b);i(c,{duration:700,easing:"easeInQuad"}),f(function(){a.$broadcast("slideToggle",b)},1e3)},a.seek=function(b){b[0]&&b[1]&&b[2]&&(a.closeMenu(),h.applicationVariable.currentModule&&h.applicationVariable.currentModule===b[1]&&a.currentLanguage&&a.currentLanguage===b[2]?a.seekToAnchor("s"+b[0]):d.path("/"+b[1]+"/"+b[2]+"/"+b[0]))},a.orderItemByIdFunction=function(a){return parseInt(a.id)},a.orderItemByKandidatnrFunction=function(a){return parseInt(a.candidate_number)}}]),HMS.service("DataService",["$http","CONSTANTS",function(a,b){var c,d={currentModule:"1",currentLanguage:"no",anchorToSeek:""},e=function(a){for(var b,c,d=a.length;0!==d;)c=Math.floor(Math.random()*d),d-=1,b=a[d],a[d]=a[c],a[c]=b;return a},f=function(b,c,d){return a({method:"post",url:d,data:{action:b,data:c},headers:{"Content-Type":"application/x-www-form-urlencoded"}})};return a.get(b.DICTIONARY_NAME).then(function(a){c=a.data}),{serverRequest:f,getDictionary:function(){return c},getDictionaryKeys:function(){return Object.keys(c)},getDictionaryValues:function(a){return c[a]},shuffle:e,applicationVariable:d}}]);var GDirectives=angular.module("GDirectives",[]);GDirectives.directive("slideable",function(){return{restrict:"C",compile:function(a){var b=a.html();return a.html('<div class="slideable_content" style="margin:0 !important; padding:0 !important">'+b+"</div>"),function(a,b,c){c.duration="undefined"==typeof c.duration?"1s":c.duration,c.easing="undefined"==typeof c.easing?"ease-in-out":c.easing,c.delay="undefined"==typeof c.delay?"1s":c.delay,b.css({overflow:"hidden",height:"0px",padding:"0",transitionProperty:"height, padding",transitionDuration:c.duration,transitionTimingFunction:c.easing,transitionDelay:c.delay})}}}}),GDirectives.directive("sliderToggle",["$timeout","$window",function(a,b){return{restrict:"A",link:function(c,d,e){function f(){g||(g=document.querySelector(e.sliderToggle)),h||(h=g.querySelector(".slideable_content"));var c=angular.element(g);if(e.expanded)i||(j&&c.removeClass("sectionDetail_open"),g.style.height="0px",g.style.padding="0");else{var d=h.clientHeight;if(g.style.height=d+"px",g.style.padding="10px 0",j){var f=b.innerWidth;f>=1280?g.style.padding="50px 43% 50px 7%":f>=1024?g.style.padding="50px 30% 50px 7%":f>=768?g.style.padding="50px 15% 50px 7%":f>=480?g.style.padding="50px 5% 50px 5%":f>=320&&(g.style.padding="50px 7% 50px 7%"),a(function(){g.style.height="100%",g.style.padding=null,c.addClass("sectionDetail_open")},2e3)}}e.expanded=!e.expanded}e.expanded=!1;var g,h,i="true"===e.preventClose,j="true"===e.sectionDetailArea;"true"===e.clickToActivate&&d.off("click").bind("click",f),c.$on("slideToggle",function(a,b){b===e.sid&&f()})}}}]),GDirectives.directive("ngEnter",["$timeout",function(a){return function(b,c,d){c.bind("keydown keypress",function(c){13===c.which&&(a(function(){b.$eval(d.ngEnter)}),c.preventDefault())})}}]),GDirectives.directive("gVideo",["$window","$document","$route","$sce","$timeout","smoothScroll","CONSTANTS",function(a,b,c,d,e,f,g){var h=function(b,h){var i=c.current.params.module;b.moduleColour=g.moduleColours[i],b.showVideo=!1;var j="";b.noPreloadGifSrc=j+b.poster,b.backgroundImageSrc="url("+(j+b.poster)+")",b.backgroundImageHeightSwitch=!1,b.overlayIconSrc=g.ICON_PATH+b.icon,b.videoSrc="",b.overlayText="";var k,l=!0,m=!1;"undefined"==typeof b.videosrc&&(b.videosrc=""),j=(g.USE_ALT_VIDEO_SERVER?g.ALT_VIDEO_PATH:g.TOP_LEVEL_MODULE_PATH)+i+"/img/",b.videoSrc=j+b.videosrc,b.noPreloadGifSrc=j+b.poster,b.backgroundImageSrc="url("+(j+b.poster)+")",b.$on("$routeChangeSuccess",function(){b.videoPath=g.TOP_LEVEL_MODULE_PATH+i+"/img/",b.noPreloadGifSrc=j+b.poster,b.backgroundImageSrc="url("+(j+b.poster)+")",n()});var n=function(){"no"===c.current.params.lingo?b.overlayText=b.textNo:b.overlayText=b.textEn},o=function(){m=!1,l=!0,k.pause(),k.removeEventListener("ended",o)};b.trustResource=function(a){return d.trustAsResourceUrl(a)},b.play=function(){a.innerWidth>=g.CROP_MIN_WIDTH&&(b.backgroundImageHeightSwitch=!0),l&&e(function(){f(h[0],{duration:500}),b.$broadcast("slideToggle",b.sid)},100),""!==b.gifsrc&&"false"===b.forceIphoneVideo&&a.innerWidth<g.GIF_MAX_WIDTH?b.noPreloadGifSrc=j+b.gifsrc:""!==b.videosrc&&(b.showVideo=!0,m?(k.pause(),m=!1):(l&&(k.addEventListener("ended",o),k.currentTime=0),k.play(),l=!1,m=!0))},e(function(){n(),k=h.find("video")[0]})};return{restrict:"E",replace:!0,scope:{poster:"@",videosrc:"@",altVideosrc:"@",gifsrc:"@",sid:"@",module:"@",textNo:"@",textEn:"@",icon:"@",forceIphoneVideo:"@",broadcast:"&"},link:h,templateUrl:"views/templates/sectionbox.html"}}]),GDirectives.directive("readmore",["$timeout",function(a){var b=function(b){var c,d,e=!1;b.addlowerborder=!0,b.type&&"task"===b.type?c=d="views/icons/widgets/oppgave/704-compose@2x.svg":(d="views/icons/body/readmore/remove.svg",c="views/icons/body/readmore/readmore.svg"),b.readmoreImageSrc=c,b.toggleIcon=function(){a(function(){e=!e,e?(b.readmoreImageSrc=d,b.addlowerborder=!1):(b.readmoreImageSrc=c,b.addlowerborder=!0)},1e3)}};return{templateUrl:"views/templates/readmore.html",restrict:"A",transclude:!0,link:b,scope:{rid:"@",title:"@",type:"@"}}}]),GDirectives.directive("quickquestion",[function(){var a=function(a){a.answerState=!1,a.answer=function(){a.answerState=!a.answerState}};return{templateUrl:"views/templates/quickquestion.html",restrict:"A",transclude:!0,link:a,scope:{gQuestion:"@",gAnswer:"@"}}}]),GDirectives.directive("greybox",[function(){var a=function(a){a.icon="",a.type&&("funfact"===a.type?a.icon="views/icons/body/greybox/870-smile@2x.svg":"warning"===a.type?a.icon="views/icons/body/greybox/791-warning@2x.svg":"story"===a.type?a.icon="views/icons/body/greybox/961-book-32@2x.svg":"quote"===a.type&&(a.icon="views/icons/body/greybox/quotation.svg"))};return{templateUrl:"views/templates/greybox.html",link:a,restrict:"A",transclude:!0,scope:{type:"@"}}}]),GDirectives.directive("quotebox",[function(){return{templateUrl:"views/templates/quotebox.html",restrict:"A",transclude:!0,scope:{type:"@"}}}]),GDirectives.directive("glink",[function(){var a=function(a){a.ipath="views/icons/body/702-share.svg"};return{template:'<a class="glink" href="{{href}}" target="_blank"><ng-transclude></ng-transclude><ng-include src="ipath"></ng-include></a>',restrict:"E",transclude:!0,link:a,scope:{href:"@"}}}]),GDirectives.directive("moduletitle",["$route",function(a){var b=function(b){"en"===a.current.params.lingo?(b.module=b.hModuleEn,b.quote=b.hQuoteEn):(b.module=b.hModuleNo,b.quote=b.hQuoteNo)};return{template:'<div><div class="topQuoteMarks" aria-hidden="true"><span>â€œ</span></div><div class="topQuoteText"><span class="topQuote">{{quote}}</span><p class="topSubtitle">{{module}}</p></div></div>',restrict:"E",link:b,scope:{hModuleNo:"@",hQuoteNo:"@",hModuleEn:"@",hQuoteEn:"@"}}}]),GDirectives.directive("hmssection",["$route","CONSTANTS",function(a,b){return{templateUrl:function(c,d){var e=b.TOP_LEVEL_MODULE_PATH+a.current.params.module+"/sub/"+d.id+"_"+a.current.params.lingo+".html"||"/defaultContent.html";return e},restrict:"A",scope:{id:"@"}}}]),GDirectives.directive("poll",["$http","$route","DataService","CONSTANTS",function(a,b,c,d){var e=function(a){var e,f,g;a.chartData="",a.radioTempData={state:-1};var h={quizpoll_id:a.hId,ids:[]};a.reload=function(i){h.quizpoll_id=a.hId,h.ids=[],c.serverRequest("getQuizPoll",h,d.QUIZPOLL_SS_PG_ABSOLUTE).success(function(c){e=c.data,g=b.current.params.module,a.radioTempData={state:-1},a.title=e.title||"(placeholder title)",a.intro=e.intro,a.summarypass=e.summarypass,a.summaryfail=e.summaryfail,a.image_url=e.image_url,a.answers=[],a.currentQuestion=e.questions[0],a.currentQuestion.answers.forEach(function(b){var c={aid:b.id,checked:!1};a.answers.push(c)}),f=d.QUIZ_IMAGE_PATH,a.image_url=""!==a.currentQuestion.image_url?f+a.currentQuestion.image_url:"",i&&a.start()})},a.check=function(b){if(a.radioTempData.state=b,"checkbox"===a.currentQuestion.type)a.answers[b].checked=!a.answers[b].checked;else if("radio"===a.currentQuestion.type){for(var c=0;c<a.currentQuestion.answers.length;c++)a.answers[c].checked=!1;a.answers[b].checked=!0}},a.next=function(){a.pieData=[];var b=0;a.currentQuestion.answers.forEach(function(c,d){b+=c.tally+(a.answers[d].checked?1:0)}),a.currentQuestion.answers.forEach(function(c,d){var e=(a.answers[d].checked?1:0)+c.tally;a.chartData+=e+",",a.pieData.push((100*e/b).toFixed(2)),a.answers[d].checked&&h.ids.push(c.id)}),a.chartData=a.chartData.substring(0,a.chartData.length-1),c.serverRequest("incrementTally",h,d.QUIZPOLL_SS_PG_ABSOLUTE).success(function(){a.state="result"}),a.state="result";var e=angular.element(document.querySelector("#poll-"+a.hId));e[0].focus()},a.start=function(){a.state="question"},a.reload(!0)};return{restrict:"E",scope:{hId:"=",hFeedback:"@"},link:e,templateUrl:"views/templates/poll.html"}}]).directive("bars",function(){return{restrict:"E",replace:!0,link:function(a,b,c){function d(a){var b=0;return a.forEach(function(a){b+=parseInt(a)}),b}a.index=c.index;var e=c.data.split(","),f=c.total||d(e);d3.select(b[0]).append("div").attr("class","chart").selectAll("div").data(e).enter().append("div").transition().ease("elastic").style("width",function(a){return 100*a/f+"%"}).text(function(a){return"0"!==a?a+"%":""})}}}),GDirectives.directive("quiz",["$http","$route","$timeout","$sce",function(a,b,c,d){var e=function(b){var e;b.filePath="",b.showLoginButton=!1,b.showAlreadyPassedDownloadButton=!1,b.showLanguageSwitch=!1,b.inSecondLanguage=!1,b.incorrectAnswers=[],b.quizpoll={},"undefined"==typeof b.hShuffleQuestions&&(b.hShuffleQuestions=!1),b.trustResource=function(a){return d.trustAsHtml(a)},b.chooseLanguage=function(a){b.inSecondLanguage=a,b.reload(!0)},b.reload=function(){a({method:"GET",url:"json/quizpolls.json"}).then(function(a){b.quizpoll=a.data.quizpolls[b.qid],e=b.quizpoll,b.state="begin",b.type="radio",b.totalPages=e.questions.length,b.radioTempData={state:-1},b.title=e.title||"(placeholder title)",b.intro=e.intro,b.percentScore=0,b.diploma_link="",b.passPercent=80,b.summarypass=e.summarypass,b.summaryfail=e.summaryfail,b.image_url=e.image_url,b.currentQuestion={},b.data={answers:[],student_id:"",score:0},b.filePath="img/quiz/"})},b.check=function(a){if("question"===b.state){if("checkbox"===b.currentQuestion.type){b.currentData[a]=!b.currentData[a],b.resultDisabled=!0;for(var c=0;c<b.currentData.length;c++)b.currentData[c]&&(b.resultDisabled=!1)}else if("radio"===b.currentQuestion.type){b.radioTempData.state=a;for(var d=0;d<b.currentData.length;d++)b.currentData[d]=!1;b.currentData[a]=!0,b.resultDisabled=!1}b.answer()}},b.clickStart=function(){b.start()},b.start=function(){b.pageIndex=-1,b.currentData=null,b.responseStatus="",b.resultDisabled=!0,b.maxscore=0,b.data.score=0,b.data.answers=[],e.questions.forEach(function(a){var c=[].repeat(!1,a.answers.length);b.data.answers.push(c);for(var d=0;d<a.answers.length;d++)a.answers[d].correct&&b.maxscore++}),b.next()},b.answer=function(){if("radio"===b.currentQuestion.type)b.currentQuestion.answers[b.radioTempData.state].correct?b.data.score++:b.incorrectAnswers.push(b.currentQuestion.text);else if("checkbox"===b.currentQuestion.type)for(var a=0;a<b.currentQuestion.answers.length;a++)b.currentQuestion.answers[a].correct&&b.currentData[a]?b.data.score++:b.currentQuestion.answers[a].correct===!1&&b.currentData[a]===!0?(b.data.score--,b.incorrectAnswers.push(b.currentQuestion.text)):b.incorrectAnswers.push(b.currentQuestion.text);var d=Math.floor(b.data.score/b.maxscore*100);b.percentScore=0>d?0:d,c(function(){b.state="result"},0)},b.next=function(){b.state="question",b.pageIndex++,b.resultDisabled=!0,b.radioTempData.state=-1,b.pageIndex===b.totalPages?b.state="end":(b.currentData=b.data.answers[b.pageIndex],b.currentQuestion=e.questions[b.pageIndex],b.type=b.currentQuestion.type,b.image_url=""!==b.currentQuestion.image_url?b.filePath+b.currentQuestion.image_url:"")},b.reload(!1)};return{restrict:"E",link:e,templateUrl:"views/templates/quiz-template.html",scope:{qid:"@"}}}]);